# 关于MySQL的配置项和命令相关内容集结

## 配置项（参数）

> mysql配置插件相关的参数 只能在插件加载之后设置，如果想启动时设置这些参数并且启动后加载插件到配置文件中，可以在参数前加上“loose_”前缀。

|                 参数名                  |                           参数释义                           |                    参数值默认值（可选值）                    |                            超链接                            |  MySQL支持版本  |
| :-------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :-------------: |
|            net_buffer_length            |                     服务端结果集缓存大小                     |                        16k（最大1G）                         | [查询数据过多，内存怎么处理](bug_你有我也有/(查询)查询数据过多，内存怎么处理.md) |                 |
|         innodb_buffer_pool_size         |                          内存页大小                          |              一般推荐设置可用物理内存的60%-80%               | [查询数据过多，内存怎么处理](bug_你有我也有/(查询)查询数据过多，内存怎么处理.md) |                 |
|         innodb_old_blocks_time          |             内存页LRU链表old数据变young持续时间              |                         1000，单位ms                         | [查询数据过多，内存怎么处理](bug_你有我也有/(查询)查询数据过多，内存怎么处理.md) |                 |
|            join_buffer_size             |     join操作时由于被驱动表无索引在内存中做匹配的内存大小     |                             256K                             |      [Join的使用问题](bug_你有我也有/Join的使用问题.md)      |                 |
|     innodb_flush_log_at_trx_commit      |                       redolog刷盘策略                        | 0:主线程每s刷盘；1:每次刷盘，提交必须落盘；2：刷到os cache中，可能1s后才会写入磁盘（只有1是安全的） | [MySQL的更新](do_it_by_myself/MySQL的更新.md)，[MySQL的binlog和redolog的优化](do_it_by_myself/MySQL的binlog和redolog的优化.md) |                 |
|               sync_binlog               |                     binlog刷盘同批次数量                     |  0:表示MySQL不控制binlog刷新；>0:每x次事务提交，刷新binlog   | [MySQL的更新](do_it_by_myself/MySQL的更新.md)，[MySQL的binlog和redolog的优化](do_it_by_myself/MySQL的binlog和redolog的优化.md) |                 |
|         innodb_log_buffer_size          |                       logbuffer的大小                        |                                                              | [MySQL的binlog和redolog的优化](do_it_by_myself/MySQL的binlog和redolog的优化.md) |                 |
|     binlog_group_commit_sync_delay      |             表示binlog延迟多少微妙后才调用fsync              |                                                              | [MySQL的binlog和redolog的优化](do_it_by_myself/MySQL的binlog和redolog的优化.md) |                 |
| binlog_group_commit_sync_no_delay_count |             表示binlog累积多少次以后才调用fsync              |                                                              | [MySQL的binlog和redolog的优化](do_it_by_myself/MySQL的binlog和redolog的优化.md) |                 |
|           slave-parallel-type           |                       主备并行复制策略                       |   DATABASE：按库并行复制；LOGICAL_CLOCK：事务优化并行复制    | [MySQL的备库并行复制](do_it_by_myself/MySQL的备库并行复制.md) |       5.7       |
| binlog-transaction-dependency-tracking  |               控制是否使用心得主备并行复制策略               | COMMIT_ORDER：使用5.7的并行复制策略；WRITESET：事务间根据操作行并行；WRITESET_SESSION：在WRITESET的基础下保证执行顺序 | [MySQL的备库并行复制](do_it_by_myself/MySQL的备库并行复制.md) |     5.7.22      |
|           session_track_gtids           |                         返回GTID开关                         |              OWN_GTID：可以从返回包里解析出GTID              |    [MySQL的读写分离](do_it_by_myself/MySQL的读写分离.md)     |      5.7.6      |
|          transation-isolation           |                           隔离级别                           |                             rr等                             |    [MySQL的事务隔离](do_it_by_myself/MySQL的事务隔离.md)     |                 |
|             tmp_table_size              |              内存临时表大小，超过后会转为磁盘表              |                             16M                              |    [MySQL的随机取值](do_it_by_myself/MySQL的随机取值.md)     |                 |
|    internal_tmp_disk_storage_engine     |                       磁盘临时表的引擎                       |                            InnoDB                            |    [MySQL的随机取值](do_it_by_myself/MySQL的随机取值.md)     |                 |
|        innodb_lock_wait_timeout         |                     死锁出现后的退出时间                     |                             40S                              |          [MySQL的锁](do_it_by_myself/MySQL的锁.md)           |                 |
|         innodb-deadlock-detect          |                       死锁检测是否开启                       |                         on:表示开启                          |          [MySQL的锁](do_it_by_myself/MySQL的锁.md)           |                 |
|      innodb_change_buffer_max_size      |              change buffer占用buffer pool的大小              |       如果是50的话就是changebuffer占用bufferpool的50%        | [MySQL的唯一索引和普通索引](do_it_by_myself/MySQL的唯一和普通索引.md) |                 |
|              binlog_format              |                        binlog日志格式                        |                     row,statement,mixed                      |   [MySQL误删数据](do_it_by_myself/MySQL的误删数据找回.md)    |                 |
|            binlog_row_image             |                     binlog-ROW的记录格式                     | FULL：全部；minimal：记录影响后的行；noblob：记录除了text，blob的列 |   [MySQL误删数据](do_it_by_myself/MySQL的误删数据找回.md)    |                 |
|            sql_safe_updates             |                       sql语句误删控制                        |           on:不能执行delete，update后面没有where的           |   [MySQL误删数据](do_it_by_myself/MySQL的误删数据找回.md)    |                 |
|            log_slave_updates            |                   备库update是否生成binlog                   |               on:备库执行relaylog后生成binlog                |    [MySQL的主备一致](do_it_by_myself/MySQL的主备一致.md)     |                 |
|            slave_skip_errors            |                      设置跳过指定的错误                      |                       例如1001，1004等                       |      [MySQL的主从库](do_it_by_myself/MySQL的主从库.md)       |                 |
|         sql_slave_skip_counter          |                        主动跳过错误数                        |                                                              |      [MySQL的主从库](do_it_by_myself/MySQL的主从库.md)       |                 |
|                gtid_mode                |                   主备同步是否使用GTID模式                   |                           on：开启                           |      [MySQL的主从库](do_it_by_myself/MySQL的主从库.md)       |                 |
|        enforce_gtid_consistency         |                   主备同步是否使用GTID模式                   |                           on：开启                           |      [MySQL的主从库](do_it_by_myself/MySQL的主从库.md)       |                 |
|            binlog_cache_size            |              单个线程内binlog cache占内存的大小              |                                                              | [MySQL的binlog和redolog的优化](do_it_by_myself/MySQL的binlog和redolog的优化.md) |                 |
|            sort_buffer_size             |      为排序开辟的内存大小，如果高于这个就会使用外部排序      |                                                              |     [MySQL的orderBy](do_it_by_myself/MySQL的orderBy.md)      |                 |
|        max_length_for_sort_data         |                         单行大小限制                         |                 超过这个大小会采用其他的算法                 |     [MySQL的orderBy](do_it_by_myself/MySQL的orderBy.md)      |                 |
|             max_connections             |                          最多连接数                          |                                                              | [突然就提高性能的方法](bug_你有我也有/突然就提交性能的方法.md) |                 |
|           innodb_io_capacity            |                          磁盘io性能                          |                                                              | [MySQL给你突然抖一抖你怕不怕](bug_你有我也有/(WAL)(缓存)MySQL给你突然抖一抖你怕不怕.md) |                 |
|       innodb_max_dirty_pages_pct        |                           脏页比例                           |                         75（0-100）                          | [MySQL给你突然抖一抖你怕不怕](bug_你有我也有/(WAL)(缓存)MySQL给你突然抖一抖你怕不怕.md) |                 |
|         innodb_flush_neighbors          |                         刷脏连坐机制                         |                      1:连坐；0:只刷自己                      | [MySQL给你突然抖一抖你怕不怕](bug_你有我也有/(WAL)(缓存)MySQL给你突然抖一抖你怕不怕.md) | 8以后默认不开启 |
|        innodb_thread_concurrency        |                      InnoDB并发线程上限                      |                          0：不限制                           |      [MySQL判活](bug_你有我也有/(主备主从)MySQL判活.md)      |                 |
|        innodb_thread_sleep_delay        |                         线程睡眠时间                         |                            单位ms                            |      [MySQL判活](bug_你有我也有/(主备主从)MySQL判活.md)      |                 |
|        inndb_concurrency_tickets        |               线程进入后获取的ticket（时间片）               |                             5000                             |      [MySQL判活](bug_你有我也有/(主备主从)MySQL判活.md)      |                 |
|          read_rnd_buffer_size           |                 回表的时候主键排序的空间大小                 |                                                              |      [Join的使用问题](bug_你有我也有/Join的使用问题.md)      |                 |
|         table_definition_cache          |              打开表实例数量，超过会根据LRU淘汰               |                 一般不会很大，其实最大就2000                 | https://www.cnblogs.com/hzcya1995/archive/2004/01/13/13311797.html |                 |
|          auto_increment_offset          |                          自增初始值                          |                              1                               |    [MySQL的自增主键](do_it_by_myself/MySQL的自增主键.md)     |                 |
|        auto_increment_increment         |                           自增步长                           |                              1                               |    [MySQL的自增主键](do_it_by_myself/MySQL的自增主键.md)     |                 |
|        innodb_autoinc_lock_mode         |                          自增锁策略                          |                   1（0，2(MySQL8.0默认)）                    |    [MySQL的自增主键](do_it_by_myself/MySQL的自增主键.md)     |                 |
|         lower_case_table_names          |                          表名大小写                          |    1，不允许在配置文件中定义，需要在初始化的时候进行定义     |                                                              |                 |
|           performance_schema            |                      是否收集服务器信息                      |                            ON/OFF                            |                                                              |                 |
| performance_schema_max_table_instances  |                       检测表的最大数量                       |                            12500                             |                                                              |                 |
|            table_open_cache             | 缓存数据文件的描述符([Linux](http://lib.csdn.net/base/linux)/Unix)相关信息 |                             2000                             |                                                              |                 |
|       innodb_buffer_pool_dump_now       | 重启后是否自动加载buffer_pool,开启后会在关闭前生成文件ib_buffer_pool |                            ON/OFF                            |                                                              |                 |
|   innodb_buffer_pool_dump_at_shutdown   | 指定在MySQL服务器关闭时是否记录在InnoDB缓冲池中缓存的页面,以便在下次重新启动时缩短预热过程 |                        默认开启ON/OFF                        |                                                              |                 |
|         bulk_insert_buffer_size         |                  insert大量数据的时候的优化                  |                  120M(非默认仅随便填写的值)                  |                                                              |                 |
|            thread_cache_size            |             Thread Cache池中应该存放的连接线程数             |                                                              |                                                              |                 |
|              thread_stack               |        每个连接线程被创建时，MySQL给它分配的内存大小         |                                                              |                                                              |                 |
|         optimizer_search_depth          |                多表join的情况优化器的递归深度                |                              61                              |                                                              |                 |
|     innodb_data_file_purge_interval     |                  清理数据文件时间间隔（ms）                  |                             100                              |                                                              |                 |
|             max_sort_length             |        排序的单条记录的值，超过这个值的部分可能被忽略        |                             1024                             |                                                              |                 |
|          max_binlog_cache_size          |                    事务可申请内存的最大值                    |                                                              |                                                              |                 |
|    innodb_online_alter_log_max_size     |    执行OnlineDDL的时候，保证增删改能够正常处理的缓存大小     |                                                              |                                                              |                 |
|            secure_file_priv             |                       限制csv文件导出                        |                             NULL                             |        [insert的锁](bug_你有我也有/Insert语句的锁.md)        |                 |

## 命令

|                           命令详情                           |                           命令意义                           |                            超链接                            | MySQL支持版本 |
| :----------------------------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :-----------: |
|                     kill query + 线程id                      |                 终止这个线程中正在执行的语句                 |        [语句kill不掉](bug_你有我也有/语句Kill不掉.md)        |               |
|                  kill [connection] + 线程id                  |          断开这个线程的连接，同时断开正在执行的语句          |        [语句kill不掉](bug_你有我也有/语句Kill不掉.md)        |               |
|                       show processlist                       |                  查看所有语句的线程id和状态                  | [语句kill不掉](bug_你有我也有/语句Kill不掉.md)，[MySQL的锁](do_it_by_myself/MySQL的锁.md) |               |
|                  show engine innodb status                   |                        查看innodb状态                        | [查询数据过多，内存怎么处理](bug_你有我也有/(查询)查询数据过多，内存怎么处理.md) |               |
|          start transaction with consistent snapshot          |                         直接启动事务                         | [MySQL的事务隔离和锁的关系](do_it_by_myself/MySQL的事务隔离和锁的关系.md) |               |
|             select xx from xx lock in share mode             |                 当前读，共享锁，只锁覆盖索引                 | [MySQL的事务隔离和锁的关系](do_it_by_myself/MySQL的事务隔离和锁的关系.md) |               |
|                 select xx from xx for update                 | 当前读，排他锁，其实排的就是lock in share mode下访问的情况，加入行锁，锁主键索引 | [MySQL的事务隔离和锁的关系](do_it_by_myself/MySQL的事务隔离和锁的关系.md) |               |
|                 Flush tables with read lock                  |                          加全局读锁                          |          [MySQL的锁](do_it_by_myself/MySQL的锁.md)           |               |
|               CHANGE MASTER TO MASTER_DELAY=N                |                 设置备库与主库保证N秒的延迟                  |   [MySQL误删数据](do_it_by_myself/MySQL的误删数据找回.md)    |               |
|                      show slave status                       |                       查询备库同步状态                       |    [MySQL的主备一致](do_it_by_myself/MySQL的主备一致.md)     |               |
| set optimizer_switch='mrr=on,mrr_cost_based=off,batched_key_access=on' |                       开启BKA Join优化                       |      [Join的使用问题](bug_你有我也有/Join的使用问题.md)      |               |
|          set optimizer_switch="mrr_cost_based=off"           |                         开启MRR优化                          |      [Join的使用问题](bug_你有我也有/Join的使用问题.md)      |               |

